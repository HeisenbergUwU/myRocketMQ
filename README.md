## ğŸš€ RocketMQ æºç å¤ç°ä¸å­¦ä¹ é¡¹ç›®

æœ¬é¡¹ç›®æ—¨åœ¨ä½œä¸ºå­¦ä¹  [Apache RocketMQ](https://rocketmq.apache.org/) çš„è¾…åŠ©èµ„æ–™ï¼Œ**é€šè¿‡æ‰‹åŠ¨å¤ç°å…¶æ ¸å¿ƒæ¨¡å—ä¸è®¾è®¡ç†å¿µ**ï¼ŒåŠ æ·±å¯¹å…¶æ¶ˆæ¯é˜Ÿåˆ—æ¨¡å‹ã€æ¶æ„è®¾è®¡ã€åº•å±‚æœºåˆ¶çš„ç†è§£ã€‚

---

### ğŸ“š é¡¹ç›®èƒŒæ™¯

RocketMQ æ˜¯é˜¿é‡Œå·´å·´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶ï¼Œç°å·²æˆä¸º Apache é¡¶çº§é¡¹ç›®ï¼Œå…·æœ‰é«˜ååã€ä½å»¶è¿Ÿã€é«˜å¯ç”¨ã€åˆ†å¸ƒå¼ã€é«˜å¯é ç­‰ç‰¹ç‚¹ã€‚

ç”±äº RocketMQ å®˜æ–¹ä»£ç ç»“æ„è¾ƒä¸ºå¤æ‚ï¼Œå¯¹äºåˆšå¼€å§‹å­¦ä¹ çš„åŒå­¦æ¥è¯´ä¸å¤ªå‹å¥½ã€‚å› æ­¤æœ¬é¡¹ç›®ä»¥â€œå¤ç° + æ‹†è§£ + æ³¨é‡Šâ€çš„æ–¹å¼ï¼Œå¸®åŠ©è¯»è€…**ä»é›¶æ­å»ºæ¶ˆæ¯é˜Ÿåˆ—æ ¸å¿ƒæ¨¡å—**ï¼ŒåŒ…æ‹¬ï¼š

* NameServer æ¨¡å—åŸç†ä¸è½»é‡çº§å®ç°
* Broker å¯åŠ¨æµç¨‹ä¸ CommitLog å­˜å‚¨æœºåˆ¶
* æ¶ˆæ¯å‘é€ã€æ¶ˆè´¹ã€æ‹‰å–åè®®
* Producer / Consumer å®¢æˆ·ç«¯æ¨¡æ‹Ÿ
* Netty é€šä¿¡åè®®å¤„ç†å™¨å®ç°
* ä»¥åŠ Zero-copyã€MappedFileã€HAæœºåˆ¶ç­‰åº•å±‚ä¼˜åŒ–æŠ€å·§

---

### ğŸ§© é¡¹ç›®ç»“æ„

```bash
rocketmq-reproduce/
â”œâ”€â”€ namesrv/                # NameServer æ¨¡å—å¤ç°
â”œâ”€â”€ broker/                 # Broker æ ¸å¿ƒç»„ä»¶æ¨¡æ‹Ÿ
â”œâ”€â”€ client/                 # Producer å’Œ Consumer çš„ç®€å•å®ç°
â”œâ”€â”€ common/                 # å…¬å…±å·¥å…·ç±»ï¼ˆé…ç½®ã€æ—¥å¿—ã€åºåˆ—åŒ–ç­‰ï¼‰
â”œâ”€â”€ store/                  # CommitLog å­˜å‚¨å’Œ MappedFile ç®¡ç†
â”œâ”€â”€ net/                    # Netty é€šä¿¡åè®®å°è£…ä¸ Command ç»“æ„
â”œâ”€â”€ test/                   # å•å…ƒæµ‹è¯•ä¸è°ƒè¯•ç”¨ä¾‹
â””â”€â”€ README.md
```

---

### âœ… å·²å®ç°åŠŸèƒ½

* [x] æ¨¡æ‹Ÿ NameServer æ³¨å†Œä¸­å¿ƒä¸è·¯ç”±è¡¨
* [x] Broker å¯åŠ¨æµç¨‹ã€Topic åˆå§‹åŒ–
* [x] Producer å‘é€æ¶ˆæ¯åˆ° Broker çš„åŸºæœ¬é“¾è·¯
* [x] åŸºäº Netty çš„ RemotingCommand å°è£…ä¸è§£æ
* [x] CommitLog æ–‡ä»¶å­˜å‚¨æ¨¡æ‹Ÿï¼ˆå¸¦ MappedByteBufferï¼‰
* [x] æ¶ˆè´¹è€…æ‹‰å–æ¶ˆæ¯é€»è¾‘ã€æ¶ˆè´¹é˜Ÿåˆ—ç®¡ç†
* [x] ç®€å• HA é«˜å¯ç”¨æœºåˆ¶ä»‹ç»ä¸å®éªŒ

---

### ğŸ› ï¸ æŠ€æœ¯æ ˆ

| æ¨¡å—     | æŠ€æœ¯                     |
| ------ | ---------------------- |
| ç¼–ç¨‹è¯­è¨€   | Java 17+               |
| æ„å»ºå·¥å…·   | Maven                  |
| ç½‘ç»œé€šä¿¡   | Netty 4.x              |
| æ—¥å¿—è®°å½•   | SLF4J + Logback        |
| åºåˆ—åŒ–    | è‡ªå®šä¹‰å‘½ä»¤ç»“æ„ï¼Œå…¼å®¹ JSON        |
| IDE æ”¯æŒ | IntelliJ IDEA / VSCode |
| æ–‡æ¡£     | Markdown + æ³¨é‡Š + ç¤ºä¾‹æ—¥å¿—æ‰“å° |

---

### ğŸ§ª å¦‚ä½•è¿è¡Œ

> éœ€æå‰å®‰è£…å¥½ JDK 17 å’Œ Maven

```bash
# å…‹éš†é¡¹ç›®
git clone https://github.com/<your-username>/rocketmq-reproduce.git
cd rocketmq-reproduce

# ç¼–è¯‘
mvn clean install

# å¯åŠ¨ NameServer
java -cp target/classes namesrv.NamesrvStartup

# å¯åŠ¨ Broker
java -cp target/classes broker.BrokerStartup

# å¯åŠ¨ Producer å‘é€æµ‹è¯•æ¶ˆæ¯
java -cp target/classes client.SimpleProducer

# å¯åŠ¨ Consumer æ‹‰å–æ¶ˆæ¯
java -cp target/classes client.SimpleConsumer
```

---

### ğŸ“Œ å­¦ä¹ é‡ç‚¹ & æ³¨é‡Šè¯´æ˜

æ¯ä¸ªæ¨¡å—çš„å…³é”®ç±»ã€æ–¹æ³•ä¸­å‡æ·»åŠ äº†è¯¦ç»†æ³¨é‡Šã€‚ä¾‹å¦‚ï¼š

* `MappedFile.java`ï¼šæ¨¡æ‹Ÿ RocketMQ ä¸­ä½¿ç”¨å†…å­˜æ˜ å°„æ–‡ä»¶è¿›è¡Œé¡ºåºå†™å…¥
* `CommitLog.java`ï¼šæ¶ˆæ¯å­˜å‚¨ä¸æ–‡ä»¶åˆ†æ®µæœºåˆ¶å¤åˆ»
* `RemotingCommand.java`ï¼šä»¿ç…§ RocketMQ ç½‘ç»œå‘½ä»¤å°è£…ä¸åºåˆ—åŒ–
* `PullMessageProcessor.java`ï¼šæ¶ˆè´¹è€…æ‹‰å–æµç¨‹ä¸åç§»é‡ç®¡ç†

---

### ğŸ¯ é¡¹ç›®ç›®æ ‡

æœ¬é¡¹ç›®æ˜¯ä¸ºäº†\*\*â€œå¤ç°ä»¥æ·±å…¥ç†è§£â€\*\*ï¼Œç›®æ ‡å¹¶éå®Œå…¨åŠŸèƒ½é½å¤‡çš„ RocketMQ å‰¯æœ¬ï¼Œè€Œæ˜¯ï¼š

1. **æ­å»ºå­¦ä¹ ç¯å¢ƒ**ï¼šå¸®åŠ©è‡ªå·±ç†è§£æºä»£ç æ¶æ„ä¸æ¨¡å—èŒè´£
2. **è¿½è¸ªæ‰§è¡Œæµç¨‹**ï¼šé€šè¿‡æ—¥å¿—ä¸æ³¨é‡Šè®°å½•å®é™…è¿è¡Œè·¯å¾„
3. **å®éªŒæ¶æ„æ¼”åŒ–**ï¼šå¯ä»¥é€æ­¥æ¼”åŒ–å‡ºæ¶ˆæ¯é‡è¯•ã€æ¶ˆè´¹è¿›åº¦å­˜å‚¨ã€Topic è‡ªåŠ¨åˆ›å»ºç­‰è¿›é˜¶æœºåˆ¶
4. **åç»­å¯è§†åŒ–**ï¼šæœªæ¥å¯èƒ½åŠ å…¥ç®€å•çš„ Web æ§åˆ¶å°

---

### ğŸ“– æ¨èé…å¥—èµ„æ–™

* [RocketMQ å®˜æ–¹æ–‡æ¡£](https://rocketmq.apache.org/docs/)
* æºç ç‰ˆæœ¬å‚è€ƒï¼š[rocketmq-all 4.9.7](https://github.com/apache/rocketmq/tree/4.9.7)
* Netty å®˜æ–¹å…¥é—¨æ•™ç¨‹
* Java NIO ä¸ MappedByteBuffer è¯¦è§£

---

### ğŸ™‹â€â™‚ï¸ ä½œè€…ç¬”è®°

æœ¬é¡¹ç›®ç”±ä¸ªäººä¸ºå­¦ä¹  RocketMQ è€Œæ­å»ºã€‚æ¯ä¸€ä»½ä»£ç èƒŒåéƒ½åŠ›æ±‚â€œ**ä»æºç å­¦è®¾è®¡**â€ï¼Œå¦‚æœä½ ä¹Ÿæœ‰ç±»ä¼¼çš„ç›®æ ‡ï¼Œæ¬¢è¿è®¨è®ºã€äº¤æµã€æäº¤ PRï¼